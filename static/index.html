<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>Video Broadcast</title>
        <link rel="stylesheet" href="./static/styles.css">
    </head>
    <body>
        <!-- <img src="./static/logo.jpg" alt="" style="width: 1000px; height: 000px;"> -->

        <div class="container">

            <h1>Virtual Camera Controller</h1>

            <div class="controls">
                <div class="button">
                    <button onclick="getDevices()">List Devices</button>
                    <button onclick="startStream()">Start Devices</button>
                    <button onclick="stopStream()">Stop Devices</button>
                </div>

                <div class="inputs">
                    <label for="camera">Choose camera</label>
                    <select id="camera"></select>
                    
                    <label for="fps">FPS</label>
                    <input type="number" min="1" max="60" value="30" id="fps">

                    <label for="blur">Blur Strength (odd number)</label>
                    <input type="range" min="1" max="52" value="10" id="blur">

                    <label for="background">Background</label>
                    <select id="background">
                        <option value="none">No Background</option>
                        <option value="blur">Blur</option>
                        <option value="default">Default</option>
                    </select>
                </div>
            </div>

            <div id="status">
                Status: Waiting for action...
            </div>
            
        </div>

        <script>
            function getDevices() {
                fetch("/devices")
                .then(response => response.json())
                .then(data => {
                    const select = document.getElementById("camera");
                    select.innerHTML = "";
                    data.forEach(device => {
                        select.innerHTML += `<option value="${device.id}">${device.name}</option>`
                    });
                });
            }

            function startStream() {
                const source = document.getElementById("camera").value;
                const fps = document.getElementById("fps").value;
                const blur = document.getElementById("blur").value;
                const background = document.getElementById("background").value;
                
                fetch(`/start?source=${source}&fps=${fps}&blur=${blur}`)
                .then()
            }
        </script>
    </body>

</html>
